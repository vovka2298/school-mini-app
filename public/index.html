async function showBookings() {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.tab')[1].classList.add('active');
  
  document.getElementById('content').innerHTML = `
    <div class="loading">
      –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...
    </div>
  `;
  
  try {
    const response = await fetch(`/api/bookings/${MY_ID}?t=${Date.now()}`);
    const data = await response.json();
    
    if (data.bookings.length === 0) {
      document.getElementById('content').innerHTML = `
        <div class="loading">
          –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫
        </div>
      `;
      return;
    }
    
    let html = '<div style="padding: 16px;">';
    html += '<h3 style="margin-top: 0; margin-bottom: 16px;">–ó–∞—è–≤–∫–∏ –æ—Ç —É—á–µ–Ω–∏–∫–æ–≤</h3>';
    
    data.bookings.forEach(booking => {
      const statusColors = {
        'pending': '#ffa500',
        'confirmed': '#238636',
        'cancelled': '#da3633',
        'completed': '#8b949e'
      };
      
      const statusTexts = {
        'pending': '–û–∂–∏–¥–∞–Ω–∏–µ',
        'confirmed': '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ',
        'cancelled': '–û—Ç–º–µ–Ω–µ–Ω–æ',
        'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω–æ'
      };
      
      html += `
        <div style="
          background: #161b22;
          border-radius: 12px;
          padding: 16px;
          margin-bottom: 12px;
          border-left: 4px solid ${statusColors[booking.status] || '#8b949e'};
        ">
          <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
              <strong>${booking.first_name} ${booking.last_name || ''}</strong>
              <div style="font-size: 14px; color: #8b949e; margin-top: 4px;">
                üìÖ ${booking.day}, ${booking.time_slot}
              </div>
              <div style="font-size: 14px; margin-top: 4px;">
                –ü—Ä–µ–¥–º–µ—Ç: ${booking.subject || '–ù–µ —É–∫–∞–∑–∞–Ω'}
              </div>
            </div>
            <div style="text-align: right;">
              <div style="
                background: ${statusColors[booking.status] || '#8b949e'};
                color: white;
                padding: 4px 12px;
                border-radius: 20px;
                font-size: 12px;
                display: inline-block;
              ">
                ${statusTexts[booking.status] || booking.status}
              </div>
              ${booking.status === 'pending' ? `
                <div style="margin-top: 8px;">
                  <button onclick="updateBooking(${booking.id}, 'confirmed')" 
                    style="
                      background: #238636;
                      color: white;
                      border: none;
                      padding: 6px 12px;
                      border-radius: 6px;
                      font-size: 12px;
                      margin-right: 4px;
                      cursor: pointer;
                    ">
                    ‚úì –ü—Ä–∏–Ω—è—Ç—å
                  </button>
                  <button onclick="updateBooking(${booking.id}, 'cancelled')"
                    style="
                      background: #da3633;
                      color: white;
                      border: none;
                      padding: 6px 12px;
                      border-radius: 6px;
                      font-size: 12px;
                      cursor: pointer;
                    ">
                    ‚úï –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                  </button>
                </div>
              ` : ''}
            </div>
          </div>
          <div style="font-size: 12px; color: #8b949e; margin-top: 8px;">
            –°–æ–∑–¥–∞–Ω–æ: ${new Date(booking.created_at).toLocaleDateString('ru-RU')}
          </div>
        </div>
      `;
    });
    
    html += '</div>';
    document.getElementById('content').innerHTML = html;
    
  } catch (error) {
    document.getElementById('content').innerHTML = `
      <div class="error">
        –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞—è–≤–æ–∫
        <br>
        <button onclick="showBookings()" style="margin-top: 20px;">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
      </div>
    `;
  }
}

// –î–æ–±–∞–≤—å—Ç–µ –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
window.updateBooking = async function(bookingId, status) {
  try {
    const response = await fetch(`/api/booking/${bookingId}/status?t=${Date.now()}`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ status })
    });
    
    if (response.ok) {
      showNotice(`–ó–∞—è–≤–∫–∞ ${status === 'confirmed' ? '–ø—Ä–∏–Ω—è—Ç–∞' : '–æ—Ç–∫–ª–æ–Ω–µ–Ω–∞'}`, 
                status === 'confirmed' ? '#238636' : '#da3633');
      showBookings();
    }
  } catch (error) {
    showNotice('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è', '#da3633');
  }
};
